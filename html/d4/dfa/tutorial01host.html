<!-- HTML header for doxygen 1.8.6-->
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.14"/>
<title>ObjGL: Tutorial - ObjGL Host</title>
<link href="../../objgl.ico" rel="shortcut icon" type="image/x-icon" />
<link href="../../tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../jquery.js"></script>
<script type="text/javascript" src="../../dynsections.js"></script>
<link href="../../search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../search/searchdata.js"></script>
<script type="text/javascript" src="../../search/search.js"></script>
<script type="text/x-mathjax-config">
  MathJax.Hub.Config({
    extensions: ["tex2jax.js"],
    jax: ["input/TeX","output/HTML-CSS"],
});
</script><script type="text/javascript" async src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.2/MathJax.js"></script>
<link href="../../doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<!--#include virtual="/google-search.html"-->
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectlogo"><img alt="Logo" src="../../ObjGL64px.png"/></td>
  <td style="padding-left: 0.5em;">
   <div id="projectname">ObjGL
   </div>
   <div id="projectbrief">Object Graphics Libary</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<script type="text/javascript">
//<![CDATA[
function getLabelName(innerHTML) {
    var str = innerHTML.toLowerCase();
    // Replace all '+' with 'p'
    str = str.split('+').join('p');
    // Replace all ' ' with '_'
    str = str.split(' ').join('_');
    // Replace all '#' with 'sharp'
    str = str.split('#').join('sharp');
    // Replace other special characters with 'ascii' + code
    for (var i = 0; i < str.length; i++) {
        var charCode = str.charCodeAt(i);
        if (!(charCode == 95 || (charCode > 96 && charCode < 123) || (charCode > 47 && charCode < 58)))
            str = str.substr(0, i) + 'ascii' + charCode + str.substr(i + 1);
    }
    return str;
}
function addToggle() {
    var $getDiv = $('div.newInnerHTML').last();
    var buttonName = $getDiv.html();
    var label = getLabelName(buttonName.trim());
    $getDiv.attr("title", label);
    $getDiv.hide();
    $getDiv = $getDiv.next();
    $getDiv.attr("class", "toggleable_div label_" + label);
    $getDiv.hide();
}
//]]>
</script>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.14 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "../../search",false,'Search');
/* @license-end */
</script>
<script type="text/javascript" src="../../menudata.js"></script>
<script type="text/javascript" src="../../menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('../../',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

</div><!-- top -->
<div class="header">
  <div class="headertitle">
<div class="title">Tutorial - ObjGL Host </div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><p>This is a simple ObjGL host application tutorial! This creates an ObjGL context, caches a triangle, texture, and material, and renders it onto a GLFW window. Please refer the <b> Tutorial01Host </b> project in the SDK as you follow this tutorial.</p>
<p>The class <a class="el" href="../../d2/d28/class_triangle.html" title="Class defining a simple scene for rendering a triangle. ">Triangle</a> and member functions used in this tutorial can be found here - <a class="el" href="../../d1/db7/group__tutorial01h.html">Tutorial 01 - Sample ObjGL Host</a>.</p>
<hr/>
<h2>ObjGL Factory and Server Configuration</h2>
<p>Each host application must have an <a class="el" href="../../db/dbd/class_obj_g_l_1_1_interface.html" title="Interface is an abstract base class that defines the ObjGL host instruction set. ">ObjGL::Interface</a> component which is the fundamental entity that manages the host rendering and client messaging system.</p>
<div class="fragment"><div class="line"><a class="code" href="../../db/dbd/class_obj_g_l_1_1_interface.html">ObjGL::Interface</a>         objGL; </div></div><!-- fragment --><p>In a generic ObjGL host application, we begin with configuring the ObjGL factory, which sets the rendering device/version for the host. This is usually done through a .json config file which is passed on as a command line argument.</p>
<h3>A Sample Host Configuration JSON File</h3>
<div class="fragment"><div class="line">{</div><div class="line">  &quot;Server&quot;: {</div><div class="line">    &quot;Address&quot;: &quot;*&quot;,</div><div class="line">    &quot;Port&quot;: &quot;5557&quot;</div><div class="line">  },</div><div class="line">  &quot;OpenGL&quot;: {</div><div class="line">    &quot;Version&quot;:&quot;3.3&quot;,</div><div class="line">    &quot;Pipeline&quot;: &quot;fixed&quot;,</div><div class="line">  }</div><div class="line">}</div></div><!-- fragment --><p>As it can be seen from the above .json config file, the host computer's server configuration as well can be set with the configure method.</p>
<div class="fragment"><div class="line">objGL.<a class="code" href="../../db/dbd/class_obj_g_l_1_1_interface.html#a2fcbd1beee9c2b1c1a09a7ec2634155e">configure</a>(cfp);</div></div><!-- fragment --><p>The argument 'cfp' points to the location of the config file. Based on the factory and server information provided in the config file, appropriate initialization parameters are set. <br />
 </p><hr/>
<h2>Initialization</h2>
<p>Following the configuration, the <a class="el" href="../../d6/dc3/class_obj_g_l_1_1_factory.html" title="Factory class is an abstract base class that establishes the contract for other derived class that im...">ObjGL::Factory</a> and <a class="el" href="../../d3/de4/class_obj_g_l_1_1_server.html" title="Server class composes each host instruction into an ObjGL message and broadcasts it to all the connec...">ObjGL::Server</a> must be initialized. This is done by</p>
<div class="fragment"><div class="line">objGL.<a class="code" href="../../db/dbd/class_obj_g_l_1_1_interface.html#a29cf8ebe5ace4dc24148ca51c5c2f149">init</a>();</div></div><!-- fragment --><p>Under the hood, this initializes the choosen factory and the server, also sets in motion the server component in a new thread.</p>
<hr/>
<h2>Enabling Forwarding</h2>
<p>Afer initialization and before actual caching of any scene components, ObjGL::Forwarding must be enabled. This makes sure all the caching or rendering operation done by the host application, triggers a server action that would compose a cache or render message to be broadcasted to the clients. <br />
 </p><div class="fragment"><div class="line">objGL.<a class="code" href="../../db/dbd/class_obj_g_l_1_1_interface.html#a7caf1a6add1222bf609bebdcb6071923">enable</a>(ObjGL::Forwarding);</div></div><!-- fragment --><p>This enables the ObjGL::Forwarding flag, so the clients can receive the appropriate messages containing the commands which the client in turn uses to cache or render. This flag can also be disabled by calling a disable() method which can come handy when the host developer wants to cache or render a scene object only in host application but not in client application.</p>
<hr/>
<h2>Caching</h2>
<p>Following the configuration and intialization, we can set out to cache different ObjGL components. This includes caching the View, Volume, VertexLst, Light, Texture, and Material etc.</p>
<div class="fragment"><div class="line">pTriangle-&gt;<a class="code" href="../../d2/d28/class_triangle.html#aed57350d5a0c2c7301f9230155f24f08">cacheView</a>();</div><div class="line">pTriangle-&gt;<a class="code" href="../../d2/d28/class_triangle.html#a7f45a6b60b1e773f4d6d2fc820b980b0">cacheVolume</a>();</div><div class="line">pTriangle-&gt;<a class="code" href="../../d2/d28/class_triangle.html#a59952e6860cdcbdd44c4a785f5bfacfb">cacheLight</a>();</div><div class="line">pTriangle-&gt;<a class="code" href="../../d2/d28/class_triangle.html#aac41d6fd5dec55c6cd42bc315eb8360c">cacheTexture</a>();</div><div class="line">pTriangle-&gt;<a class="code" href="../../d2/d28/class_triangle.html#aa8ff7fe6ee1b36a7112b813a117de338">cacheMaterial</a>();</div><div class="line">pTriangle-&gt;<a class="code" href="../../d2/d28/class_triangle.html#aac9ce244d03a8d26c723d36820a1b0f9">cacheGeometry</a>();</div></div><!-- fragment --><p>In each of these functions defined in the <a class="el" href="../../d2/d28/class_triangle.html" title="Class defining a simple scene for rendering a triangle. ">Triangle</a> class, a core ObjGL component is defined and then cached. On caching, a pointer handle to the cached component is returned which is then used in render instructions to point to the appropriate cached components.</p>
<p>The following code snippet illustrates how an <a class="el" href="../../d0/d20/class_obj_g_l_1_1_view.html" title="View class defines the camera properties for ObjGL Viewport. ">ObjGL::View</a> component is cached and an <a class="el" href="../../da/db4/class_obj_g_l_1_1_view_obj.html" title="ViewObj class is an abstract base class that establishes the contract for other derived ViewObj class...">ObjGL::ViewObj</a> handle is returned.</p>
<div class="fragment"><div class="line">{</div><div class="line">glm::vec4   vR = glm::vec4(1.0f, 0.0f, 0.0f, 0.0f);</div><div class="line">glm::vec4   vU = glm::vec4(0.0f, 1.0f, 0.0f, 0.0f);</div><div class="line">glm::vec4   vD = glm::vec4(0.0f, 0.0f, -1.0f, 0.0f);</div><div class="line">glm::vec4   vP = glm::vec4(0.0f, 0.0f, 3.5f, 1.0f);</div><div class="line"></div><div class="line">glm::mat4   mP = glm::perspective(glm::radians(45.0f), 1.0f, 0.001f, 5.00f);</div><div class="line"></div><div class="line">  _view = <a class="code" href="../../d0/d20/class_obj_g_l_1_1_view.html">ObjGL::View</a>(mP, glm::mat4(vR, vU, vD, vP));</div><div class="line">}</div><div class="line"></div><div class="line">_viewObj = objGL.<a class="code" href="../../db/dbd/class_obj_g_l_1_1_interface.html#a99eeaa3f9f73d05b6e6b6bfa91a654d3">cache</a>(_view);</div></div><!-- fragment --><p>Similarly for every other component, a cache call returns a handle to the cached component.</p>
<div class="fragment"><div class="line">_volumeObj    = objGL.<a class="code" href="../../db/dbd/class_obj_g_l_1_1_interface.html#a99eeaa3f9f73d05b6e6b6bfa91a654d3">cache</a>(_volume);</div></div><!-- fragment --><div class="fragment"><div class="line">_lightObj     = objGL.<a class="code" href="../../db/dbd/class_obj_g_l_1_1_interface.html#a99eeaa3f9f73d05b6e6b6bfa91a654d3">cache</a>(_light);</div></div><!-- fragment --><div class="fragment"><div class="line">_pTriangleVO = objGL.<a class="code" href="../../db/dbd/class_obj_g_l_1_1_interface.html#a99eeaa3f9f73d05b6e6b6bfa91a654d3">cache</a>(_vLst);</div></div><!-- fragment --><p>The handles returned by the cache calls are then used in render instructions to point to the corrresponding cache components.</p>
<hr/>
<h2>Rendering</h2>
<p>Once the caching is done, the render loop can begin and render instructions can be issued using the cache handles and corresponding transform properties. The three common render instructions are look(), survery(), and render(). Apart from these three render instructions, a render call or loop works with other control instructions including clear(), frameStart(), frameEnd() and finish(). <br />
 The method frameStart() begins to populate a <a class="el" href="../../db/d04/class_obj_g_l_1_1_render_bundle.html" title="RenderBundle Class packs a set of RenderSignature. ">ObjGL::RenderBundle</a> component at the start of a single frame and at the end of a frame, frameEnd() call seals the RenderBundle. This render bundling is done to avoid issuing individual render messages for each host render call. This bundles the individual render calls from the host, into a packet of render messages, before sending it across to the clients.</p>
<p>The control and render instructions are issued in a strict order(except for look() and survery() which can be interchanged) inside the render loop as shown below. </p><pre class="fragment">clear
frameStart
look
survey
render
frameEnd
finish
</pre><h3>Look and Survey</h3>
<p>The look() and survey() functions respectively sets the current view/camera and volume properties using the <a class="el" href="../../da/db4/class_obj_g_l_1_1_view_obj.html" title="ViewObj class is an abstract base class that establishes the contract for other derived ViewObj class...">ObjGL::ViewObj</a> and <a class="el" href="../../de/d61/class_obj_g_l_1_1_volume_obj.html" title="VolumeObj class is an abstract base class that establishes the contract for other derived VolumeObj c...">ObjGL::VolumeObj</a> handles.</p>
<div class="fragment"><div class="line">objGL.<a class="code" href="../../db/dbd/class_obj_g_l_1_1_interface.html#a8c44a778bafb00432504e9e997b0abe3">look</a>(_viewObj);</div><div class="line">objGL.<a class="code" href="../../db/dbd/class_obj_g_l_1_1_interface.html#a79f91d084b5fb6b876fc3588d6a926ec">survey</a>(_volumeObj);</div></div><!-- fragment --><h3>Render</h3>
<p>The render() function takes the <a class="el" href="../../d6/d58/class_obj_g_l_1_1_vertex_lst_obj.html" title="VertexLstObj class is an abstract base class that establishes the contract for other derived VertexLs...">ObjGL::VertexLstObj</a>, <a class="el" href="../../d4/daa/class_obj_g_l_1_1_texture_obj.html" title="TextureObj class is an abstract base class that establishes the contract for other derived class that...">ObjGL::TextureObj</a>, <a class="el" href="../../d6/d53/class_obj_g_l_1_1_material_obj.html" title="MaterialObj class is an abstract base class that establishes the contract for other derived MaterialO...">ObjGL::MaterialObj</a> handles as the first three components. Currently ObjGL host mandates providing a texture and a material for every geometry. The fourth component is the transform matrix of the VertexLst. The last two components set the layer and light information for the scene. <br />
 </p><div class="fragment"><div class="line">objGL.render(_pTriangleVO, _pTriangleTO, _pTriangleMO, glm::mat4(), ObjGL_LAYER0, ObjGL::Lights::ObjGL_NO_LIGHTS);</div></div><!-- fragment --><p>The scene lights are set using light bitfields. Multiple lights can be set by using OR function between the light bitfields.</p>
<hr/>
<h2>Clean Up</h2>
<p>Post the rendering, when the host application closes or it tries to cache new geometry or other components, it must be removed from the host as well as the client memeory. An array of remove() instructions are issued which clears the host cache, and also composes a remove message to be sent across to clients.</p>
<div class="fragment"><div class="line">objGL.remove(_viewObj);</div><div class="line">objGL.remove(_volumeObj);</div><div class="line"></div><div class="line">objGL.remove(_pVolumeVO);</div><div class="line">objGL.remove(_pVolumeTO);</div><div class="line">objGL.remove(_pVolumeMO);</div><div class="line"></div><div class="line">objGL.remove(_pTriangleVO);</div><div class="line">objGL.remove(_pTriangleTO);</div><div class="line">objGL.remove(_pTriangleMO);</div></div><!-- fragment --><hr/>
 </div></div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="../../doxygen.png" alt="doxygen"/>
</a> 1.8.14
</small></address>
</body>
</html>
